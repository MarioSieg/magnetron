# Operator Cheatsheet

This table documents all tensor operators exposed by Magnetron.  
All operators are **methods on `Tensor`**, not free functions.
So instead of writing `sum(x)`, you write `x.sum()`.

---

## Tensor Creation & Initialization

| Method | Description | Example |
|------|-------------|---------|
| `Tensor.empty(shape)` | Uninitialized tensor | `x = Tensor.empty(2, 3)` |
| `Tensor.empty_like(x)` | Empty tensor like input | `y = Tensor.empty_like(x)` |
| `Tensor.full(shape, v)` | Filled tensor | `x = Tensor.full((2,3), 1.0)` |
| `Tensor.full_like(x, v)` | Filled like input | `y = Tensor.full_like(x, 0)` |
| `Tensor.arange(a,b,s)` | 1D range | `x = Tensor.arange(0, 10, 2)` |
| `Tensor.rand_perm(n)` | Random permutation | `x = Tensor.rand_perm(10)` |
| `Tensor.one_hot(c)` | One-hot encode | `y = x.one_hot(10)` |
| `Tensor.load_image(p)` | Load image tensor | `img = Tensor.load_image("a.png")` |

---

## Views, Shape & Indexing

| Method | Description | Example |
|------|-------------|---------|
| `clone()` | Deep copy | `y = x.clone()` |
| `cast(dtype)` | Cast dtype | `x.cast(dtype.float16)` |
| `view(shape)` | View tensor | `x.view(2, -1)` |
| `view_slice(d,s,l)` | Slice view | `x.view_slice(0,0,4)` |
| `reshape(shape)` | Reshape | `x.reshape(4,3)` |
| `transpose(d1,d2)` | Swap dims | `x.transpose(0,1)` |
| `permute(dims)` | Reorder dims | `x.permute(1,0,2)` |
| `contiguous()` | Make contiguous | `x = x.contiguous()` |
| `squeeze()` | Remove 1-dims | `x.squeeze()` |
| `unsqueeze(d)` | Add dim | `x.unsqueeze(0)` |
| `flatten(a,b)` | Flatten dims | `x.flatten(1)` |
| `unflatten(shape)` | Unflatten | `x.unflatten((2,3))` |
| `narrow(d,s,l)` | Slice range | `x.narrow(1,0,4)` |
| `movedim(a,b)` | Move dim | `x.movedim(0,-1)` |
| `select(d,i)` | Select index | `x.select(1,2)` |
| `split(n,d)` | Split tensor | `x.split(4,1)` |
| `cat(xs,d)` | Concatenate | `Tensor.cat([a,b],1)` |
| `gather(d,idx)` | Indexed gather | `x.gather(1, idx)` |

---

## Reductions

| Method | Description | Example |
|------|-------------|---------|
| `mean()` | Mean | `x.mean()` |
| `sum()` | Sum | `x.sum()` |
| `prod()` | Product | `x.prod()` |
| `min()` | Min | `x.min()` |
| `max()` | Max | `x.max()` |
| `argmin()` | Argmin | `x.argmin()` |
| `argmax()` | Argmax | `x.argmax()` |
| `any()` | Any true | `x.any()` |
| `all()` | All true | `x.all()` |

---

## Unary Math

| Method | Description | Example |
|------|------------|---------|
| `abs()` | Absolute | `x.abs()` |
| `sgn()` | Sign | `x.sgn()` |
| `neg()` | Negate | `x.neg()` |
| `sqr()` | Square | `x.sqr()` |
| `rcp()` | 1/x | `x.rcp()` |
| `sqrt()` | √x | `x.sqrt()` |
| `rsqrt()` | 1/√x | `x.rsqrt()` |
| `log()` | ln(x) | `x.log()` |
| `log10()` | log₁₀(x) | `x.log10()` |
| `log2()` | log₂(x) | `x.log2()` |
| `log1p()` | ln(1+x) | `x.log1p()` |
| `exp()` | eˣ | `x.exp()` |
| `exp2()` | 2ˣ | `x.exp2()` |
| `expm1()` | eˣ−1 | `x.expm1()` |
| `floor()` | ⌊x⌋ | `x.floor()` |
| `ceil()` | ⌈x⌉ | `x.ceil()` |
| `round()` | Round | `x.round()` |
| `trunc()` | Truncate | `x.trunc()` |

---

## Trigonometric & Special

| Method | Description | Example |
|------|-------------|---------|
| `sin()` | Sine | `x.sin()` |
| `cos()` | Cosine | `x.cos()` |
| `tan()` | Tangent | `x.tan()` |
| `sinh()` | Sinh | `x.sinh()` |
| `cosh()` | Cosh | `x.cosh()` |
| `tanh()` | Tanh | `x.tanh()` |
| `asin()` | Arc-sin | `x.asin()` |
| `acos()` | Arc-cos | `x.acos()` |
| `atan()` | Arc-tan | `x.atan()` |
| `asinh()` | Arc-sinh | `x.asinh()` |
| `acosh()` | Arc-cosh | `x.acosh()` |
| `atanh()` | Arc-tanh | `x.atanh()` |
| `erf()` | Error fn | `x.erf()` |
| `erfc()` | Complement | `x.erfc()` |
| `step()` | Heaviside | `x.step()` |

---

## Activations

| Method | Description | Example |
|------|-------------|---------|
| `relu()` | ReLU | `x.relu()` |
| `sigmoid()` | Sigmoid | `x.sigmoid()` |
| `hard_sigmoid()` | Hard sigmoid | `x.hard_sigmoid()` |
| `silu()` | SiLU | `x.silu()` |
| `gelu()` | GELU | `x.gelu()` |
| `gelu_approx()` | Approx GELU | `x.gelu_approx()` |
| `softmax()` | Softmax | `x.softmax()` |
| `multinomial(n)` | Sampling | `x.multinomial(num_samples=1)` |

---

## Binary Arithmetic

| Method | Operator | Description | Example |
|------|----------|-------------|---------|
| `add()` | `+` | Add | `x + y` |
| `sub()` | `-` | Subtract | `x - y` |
| `mul()` | `*` | Multiply | `x * y` |
| `div()` | `/` | Divide | `x / y` |
| `mod()` | `%` | Modulo | `x % y` |
| `matmul()` | `@` | Matrix multiply | `x @ y` |

---

## Comparisons

| Operator | Description | Example |
|--------|-------------|---------|
| `==` | Equal | `x == y` |
| `!=` | Not equal | `x != y` |
| `<` | Less | `x < y` |
| `<=` | Less-equal | `x <= y` |
| `>` | Greater | `x > y` |
| `>=` | Greater-equal | `x >= y` |

---

## Logical & Bitwise

| Method | Operator | Description | Example |
|------|----------|-------------|---------|
| `logical_and()` | `&` | AND | `x & y` |
| `logical_or()` | `|` | OR | `x | y` |
| `logical_xor()` | `^` | XOR | `x ^ y` |
| `logical_not()` | `~` | NOT | `~x` |
| `shl()` | `<<` | Shift left | `x << 1` |
| `shr()` | `>>` | Shift right | `x >> 1` |

---

## Matrix Masks & Utility

| Method | Description | Example |
|------|-------------|---------|
| `tril()` | Lower triangle | `x.tril()` |
| `triu()` | Upper triangle | `x.triu()` |